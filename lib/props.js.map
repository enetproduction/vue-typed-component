{"version":3,"file":"props.js","sourceRoot":"","sources":["../src/props.ts"],"names":[],"mappings":"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","sourcesContent":["import * as Vue from \"vue\";\r\nimport { PropType } from \"./types\";\r\n\r\nexport type Supplier<T> = () => T;\r\nexport type Default<T> = T | Supplier<T>;\r\nexport type Validator<T> = (value: T) => boolean;\r\n\r\nexport type PropOrValidator<T, V> = Vue.PropOptions & V & {\r\n    Validator: (v: Validator<T>) => Vue.PropOptions\r\n};\r\n\r\nexport type PropOptionBuilder<T, TDefault, V> = PropOrValidator<T, V> & {\r\n    Required: PropOrValidator<T, V>;\r\n    Default(value: TDefault): PropOrValidator<T, V>;\r\n};\r\n\r\nfunction createPropOptionBuilder<T, TDefault, V>(type: PropType, createValidators: (base: Vue.PropOptions) => V): PropOptionBuilder<T, TDefault, V> {\r\n    function createPartial(base: Vue.PropOptions): PropOrValidator<T, V> {\r\n        return Object.assign({\r\n            Validator: (validator: Validator<T>) => <Vue.PropOptions>{ ...base, validator }\r\n        }, base, createValidators(base));\r\n    }\r\n    return Object.assign({\r\n        Required: createPartial({ type, required: true }),\r\n        Default(value: TDefault) { return createPartial({ type, default: value }); }\r\n    }, createPartial({ type }));\r\n}\r\n\r\nexport interface StringValidators {\r\n    $in(...values: string[]): Vue.PropOptions;\r\n    $match(pattern: RegExp): Vue.PropOptions;\r\n}\r\n\r\nexport const Str = createPropOptionBuilder<string, Default<string>, StringValidators>(String, base => {\r\n    const $ = (validator: Validator<string>) => ({ ...base, validator });\r\n    return {\r\n        $in: (...values) => $(v => values.indexOf(v) >= 0),\r\n        $match: pattern => $(v => pattern.test(v))\r\n    };\r\n});\r\n\r\nexport interface NumberValidators {\r\n    $lessThan(max: number): Vue.PropOptions;\r\n    $greaterThan(min: number): Vue.PropOptions;\r\n    $lessEqual(max: number): Vue.PropOptions;\r\n    $greaterEqual(min: number): Vue.PropOptions;\r\n    $between(min: number, max: number): Vue.PropOptions;\r\n    $nonZero(): Vue.PropOptions;\r\n    $positive(): Vue.PropOptions;\r\n    $nonNegative(): Vue.PropOptions;\r\n}\r\n\r\nexport const Num = createPropOptionBuilder<number, Default<number>, NumberValidators>(Number, base => {\r\n    const $ = (validator: Validator<number>) => ({ ...base, validator });\r\n\r\n    return {\r\n        $lessThan: (max) => $(v => v < max),\r\n        $greaterThan: (min) => $(v => min < v),\r\n        $lessEqual: (max) => $(v => v <= max),\r\n        $greaterEqual: (min) => $(v => min <= v),\r\n        $between: (min, max) => $(v => min <= v && v <= max),\r\n        $nonZero: () => $(v => v !== 0),\r\n        $positive: () => $(v => v > 0),\r\n        $nonNegative: () => $(v => v >= 0),\r\n    };\r\n});\r\n\r\nexport interface ArrayValidators {\r\n    $maxLength(max: number): Vue.PropOptions;\r\n    $notEmpty(): Vue.PropOptions;\r\n    $all(test: (v: any) => boolean): Vue.PropOptions;\r\n}\r\n\r\nexport const Arr = createPropOptionBuilder<any[], Supplier<any[]>, ArrayValidators>(Array, base => {\r\n    const $ = (validator: Validator<any[]>) => ({ ...base, validator });\r\n\r\n    return {\r\n        $maxLength: max => $(v => v.length <= max),\r\n        $notEmpty: () => $(v => v.length > 0),\r\n        $all: (test) => $(v => {\r\n            for (let i = 0; i < v.length; ++i) {\r\n                if (!test(v[i])) {\r\n                    return false;\r\n                }\r\n            }\r\n            return true;\r\n        })\r\n    };\r\n});\r\n\r\nexport const Bool = createPropOptionBuilder<boolean, Default<boolean>, undefined>(Boolean, base => undefined);\r\nexport const Func = createPropOptionBuilder<(...args: any[]) => any, Supplier<(...args: any[]) => any>, undefined>(Function, base => undefined);\r\nexport const Obj = createPropOptionBuilder<{}, Supplier<{}>, undefined>(Object, base => undefined);\r\nexport const Any = createPropOptionBuilder<null, any, undefined>(null, base => undefined);\r\nexport function ofType(type: PropType) {\r\n    return createPropOptionBuilder<any, any, undefined>(type, base => undefined);\r\n}\r\n\r\n"]}